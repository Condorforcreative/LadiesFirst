<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>اكمال الطلبية</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <h1>اكمال الطلبية</h1>

    <!-- Product Summary -->
    <div id="productSummary" style="border:1px solid #ccc; padding:10px; margin-bottom:15px;">
        <h2>المنتج المختار</h2>
        <p id="productName"></p>
        <p id="productPrice"></p>
        <p id="productVariant"></p>
    </div>

    <form id="checkoutForm" method="POST" action="https://formspree.io/f/YOUR_FORM_ID">
        <!-- Hidden fields to send product info -->
        <input type="hidden" name="productName" id="hiddenProductName">
        <input type="hidden" name="productPrice" id="hiddenProductPrice">
        <input type="hidden" name="productVariant" id="hiddenProductVariant">

        <label>الاسم الكامل: <input type="text" name="fullName" required></label>
        <label>اللقب: <input type="text" name="lastName" required></label>
        <label>رقم الهاتف: <input type="tel" name="phone" required></label>
        
        <label>الولاية:
            <select name="state" id="stateSelect" required>
                <option value="">اختر الولاية</option>
                <option value="Adrar">أدرار</option>
                <option value="Chlef">الشلف</option>
                <option value="Laghouat">الأغواط</option>
                <option value="Oum El Bouaghi">أم البواقي</option>
                <option value="Batna">باتنة</option>
                <option value="Béjaïa">بجاية</option>
                <option value="Biskra">بسكرة</option>
                <option value="Béchar">بشار</option>
                <option value="Blida">البليدة</option>
                <option value="Bouira">البويرة</option>
                <option value="Tamanrasset">تمنراست</option>
                <option value="Tébessa">تبسة</option>
                <option value="Tlemcen">تلمسان</option>
                <option value="Tiaret">تيارت</option>
                <option value="Tizi Ouzou">تيزي وزو</option>
                <option value="Alger">الجزائر</option>
                <option value="Djelfa">الجلفة</option>
                <option value="Jijel">جيجل</option>
                <option value="Sétif">سطيف</option>
                <option value="Saïda">سعيدة</option>
                <option value="Skikda">سكيكدة</option>
                <option value="Sidi Bel Abbès">سيدي بلعباس</option>
                <option value="Annaba">عنابة</option>
                <option value="Guelma">قالمة</option>
                <option value="Constantine">قسنطينة</option>
                <option value="Médéa">المدية</option>
                <option value="Mostaganem">مستغانم</option>
                <option value="M’Sila">المسيلة</option>
                <option value="Mascara">معسكر</option>
                <option value="Ouargla">ورقلة</option>
                <option value="Oran">وهران</option>
                <option value="El Bayadh">البيض</option>
                <option value="Illizi">إليزي</option>
                <option value="Bordj Bou Arreridj">برج بوعريريج</option>
                <option value="Boumerdès">بومرداس</option>
                <option value="El Tarf">الطارف</option>
                <option value="Tindouf">تندوف</option>
                <option value="Tissemsilt">تيسمسيلت</option>
                <option value="El Oued">الوادي</option>
                <option value="Khenchela">خنشلة</option>
                <option value="Souk Ahras">سوق أهراس</option>
                <option value="Tipaza">تيبازة</option>
                <option value="Mila">ميلة</option>
                <option value="Aïn Defla">عين الدفلى</option>
                <option value="Naâma">النعامة</option>
                <option value="Aïn Témouchent">عين تموشنت</option>
                <option value="Ghardaïa">غرداية</option>
                <option value="Relizane">غليزان</option>
                <option value="Timimoun">تيميمون</option>
                <option value="Ouled Djellal">أولاد جلال</option>
                <option value="Beni Abbes">بني عباس</option>
                <option value="In Salah">عين صالح</option>
                <option value="Touggourt">تقرت</option>
                <option value="El M’Ghair">المغير</option>
                <option value="El Meniaa">المنيعة</option>
            </select>
        </label>

        <label>المدينة: <input type="text" name="city" required></label>
        <label>الشارع: <input type="text" name="street" required></label>

        <label>نوع التوصيل:
            <select name="deliveryType" id="deliveryType" required>
                <option value="منزل">منزل</option>
                <option value="مكتب">مكتب</option>
            </select>
        </label>

        <p id="deliveryCost">تكلفة التوصيل: 0 دج</p>
        <button type="submit">تأكيد الطلب</button>
    </form>

    <script>
        // Load product from localStorage
        const selectedProduct = JSON.parse(localStorage.getItem('selectedProduct'));
        if (selectedProduct) {
            document.getElementById('productName').innerText = "المنتج: " + selectedProduct.name;
            document.getElementById('productPrice').innerText = "السعر: " + selectedProduct.price;
            document.getElementById('productVariant').innerText = "اللون/النوع: " + selectedProduct.variant;

            // Set hidden fields for submission
            document.getElementById('hiddenProductName').value = selectedProduct.name;
            document.getElementById('hiddenProductPrice').value = selectedProduct.price;
            document.getElementById('hiddenProductVariant').value = selectedProduct.variant;
        }

        const shippingRates = { /* نفس جدول الأسعار الذي وضعناه سابقاً */ };

        document.getElementById('stateSelect').addEventListener('change', updateDeliveryCost);
        document.getElementById('deliveryType').addEventListener('change', updateDeliveryCost);

        function updateDeliveryCost() {
            const state = document.getElementById('stateSelect').value;
            const delivery = document.getElementById('deliveryType').value;

            if (shippingRates[state]) {
                const cost = shippingRates[state][delivery];
                if (cost !== null && cost !== undefined) {
                    document.getElementById('deliveryCost').innerText = "تكلفة التوصيل: " + cost + " دج";
                } else {
                    document.getElementById('deliveryCost').innerText = "التوصيل غير متاح لهذا الخيار";
                }
            } else {
                document.getElementById('deliveryCost').innerText = "اختر الولاية";
            }
        }
    </script>
</body>
</html>
